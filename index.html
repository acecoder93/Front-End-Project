<!doctype html>
<html lang="en">

<head>
  <title>Title</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <style>

</style>

</head>

<body>

  <input style = "padding-left: 10px" type="text" id="cuisine-input" placeholder="cuisine">
  <button id="submit" style = "background-color:rgba(124, 166, 230, 0.781); width: 60px;">Go</button>
  <div id="information-box" style="display:flex; flex-direction: column">

  </div>
  <div id="accordion"  style ="width:80vw;display:flex; flex-direction:column; justify-content: center; align-items:center; margin-left: 2%; margin-top: 5%">
  </div>


  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>


  <script>
    // Weather Api;
    //       $(function(){
    //         var url = "http://api.openweathermap.org/data/2.5/weather?q=";
    //         var apiKey = "ad8af1d7fbacdeceed6e31526ea1682a";
    //         var toFah = function(temp){
    //         var cel = temp - 273.15
    //         var fah = Math.floor(cel * 1.8 + 32)
    //         return fah
    //     }

    //     $('#submit').on('click',function(){
    //         $('main').empty()
    //         var userInput = $('#city-input').val()
    //         var $weatherbox = $('<div>',{
    //             'id': 'weatherbox',
    //             'text': userInput,
    //         })

    //         $.get(url + userInput + '&appid=' + apiKey)
    //         .done((result)=>{
    // var $temperature = $('<div>',{
    //     'id': 'temperature',
    //     'text': toFah(result.main.temp) + String.fromCharCode(176) + "F"
    // })
    //             var $mintemp = $('<div>',{
    //                 "id": 'mintemp',
    //                 'text': 'Min Temp: ' + toFah(result.main.temp_min) + String.fromCharCode(176) + "F"
    //             })
    //             var $maxtemp = $('<div>',{
    //                 "id": 'maxtemp',
    //                 'text': 'Max Temp: ' + toFah(result.main.temp_max) + String.fromCharCode(176) + "F"
    //             })
    //             var $elements = $('<div>',{
    //                 "id": 'elements',
    //                 'text':  result.weather[0].description
    //             })
    //             console.log(result)
    //             $('main').append($weatherbox)
    //             $('#weatherbox').append($temperature)
    //             $('#weatherbox').append($elements)
    //             $('#weatherbox').append($mintemp)
    //             $('#weatherbox').append($maxtemp)

    //         })
    //     })

    // })

    // General EDAMAM API 
    $(function () {

      $('#submit').on('click', function () {
        var url = 'https://api.edamam.com/search?q=';
        var type = $('#cuisine-input').val(); // Needs to be changed based on user input
        var apiId = 'be5d1e96';
        var apiKey = '0c29a5e9ce187319b53367b2cc67256f';
        var i = $('.card').length;
        var j = Math.floor(Math.random() * 100000)
        // var cal_min = '0'; // Fixed value for minimum calories
        // var cal_max = '500'; // Needs to be changed based on user input
        $.get(url + type + '&app_id=' + apiId + '&app_key=' + apiKey + '&from=1&to=100') //'&calories=' + cal_min + '-' + cal_max + '&health=alcohol-free')
          .done((result) => {
            console.log(result);
            while (i < 10) {
              i++
              j++
              let ran = Math.floor(Math.random() * 100) // randomly take one recipe
              // let $recipe = $('<div>', {
              //   'text': result.hits[ran].recipe.label
              // })
              // let $recipeimg = $('<img>', {
              //   'src': result.hits[ran].recipe.image
              // })
              // $('#information-box').append($recipe)
              // $('#information-box').append($recipeimg)
              let $card = $('<div>', {
                'class': "card",
                'style': "width:100%; background-image: linear-gradient(rgba(229, 230, 231, 0.781), rgba(124, 166, 230, 0.781));",
                'id': 'card' + j.toString()
              })
              let $cardHeader = $('<div>', {
                'class': 'card-header',
                'style': 'width:100%; padding: 0px; display: inline;',
                'id': 'heading' + j.toString()
              })
              let $heading = $('<h5>', {
                'class': 'mb-0; mr-0',
                'id': 'h' + j.toString(),
                'style' : 'margin-right: 0%; padding: 0px'
              })
              let $collapse = $('<div>', {
                // 'class': 'btn btn-link',
                'style': 'width: 80%; text-align: left; display: inline-block; padding-left: 10px ',
                'data-toggle': 'collapse',
                'data-target': '#collapse' + j.toString(),
                'aria-expanded': 'true',
                'aria-controls': 'collapse' + j.toString(),
                'text': result.hits[ran].recipe.label
              })
              let $buttonx = $('<button>', {
                'class': 'x',
                'text': 'x',
                'style' : 'text-align: right; margin-left: 15px; position: absolute; right: 20px;'
              })
              let $box2 = $('<div>', {
                'id': 'collapse' + j.toString(),
                'class': 'collapse', // show
                'aria-labelledby': 'heading' + j.toString(),
                'data-parent': '#accordion'
              })
              let $cardbody = $('<div>', {
                'class': 'card-body',
                'style': 'background-color: rgba(102, 117, 167, 0.719); opacity: 1; margin: 0px; padding: 0px' // testing the color
              })

              // Create a unordered list with bullets for cards with content 
              var $table = $('<ul>', {
                'style' : 'padding: 0px'
              });
                var $tableData1 = $('<img>', {
                  'id' : 'Image',
                  'src' : (result.hits[ran].recipe.image),
                  'style' : 'display: block; margin-left: 0px; padding: 0px; height: 100%; width: 100%; z-index: -1;',
              })
              
              var $tableData2 = $('<li>', {
                  'id' : 'Calories',
                  'text' : Math.round(result.hits[ran].recipe.calories) + ' cal',
                  'style': 'background-color: black; opacity: .5; z-index:1'
              })
              var $tableData3 = $('<li>', {
                  'id' : 'Minutes',
                  'text' : (result.hits[ran].recipe.totalTime) + ' minutes',
                  'style': 'background-color: black; opacity: .5; position: absolute; z-index:-1'

              })

              var $overlay = $('<div>', {
                'id': 'InformationOverlay',
                'text' : Math.round(result.hits[ran].recipe.calories) + ' cal',
                'style' : 'background-color: black; height: 100px; width: 100px; position: relative; z-index: 1'
              })

              $tableData1.append($overlay);
        
              $table.append($tableData1);
              // $table.append($tableData2);
              // $table.append($tableData3);
              $cardbody.append($table);

              $('#accordion').append($card)
              $(`#card${j}`).append($cardHeader)
              $(`#heading${j}`).append($heading)
              $(`#h${j}`).append($collapse)
              $(`#h${j}`).append($buttonx)
              $(`#card${j}`).append($box2)
              $(`#collapse${j}`).append($cardbody)
              $(".x").on('click', function () {
                $(this).parents('.card').get(0).remove()
              });
            }
          })
      })
    })

      // Future feature for restaurants and locations
        // https://places.cit.api.here.com/places/v1/autosuggest?at=40.74917,-73.98529&q=chrysler&app_id={YOUR_APP_ID}&app_code={YOUR_APP_CODE}

      // $(function(){
      //   var places_url = 'https://places.demo.api.here.com/places/v1/categories/places';
      //   var places_url2 = 'https://places.cit.api.here.com/places/v1/autosuggest?at=';
      //   var app_id = 'EJdU5nn8sxHlLydgr8p6';
      //   var app_code = 'eWkjPip9_dHnYq-y9iAQ_A';
      //   var long_lat = '29.7604,95.3698'; // Houston Location
      //   var user_search = 'Chuys'; // Based upon user input

      //   $.get(places_url2 + long_lat + '&q=' + user_search + '&app_id=' + app_id + '&app_code=' + app_code).done((result)=>{
      //     console.log(result);
      //   })
      // })

  </script>


</body>

</html>